<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Mapset Generator</title>

        <style>
            body {
                font-family: monospace;
                font-size: 20px;
            }
            p#mapOutput:focus {
                background-color: gray;
                color: white;
            }
        </style>
    </head>

    <body onload = "loadKeyHandler()">

        <script>

            //Notes for the code necessary for the generator as well as necessary features
                //We need it to output valid config files given in the example file in the maps file in assets
                    //For the "map = " portion, Arrays nested in arrays will be necessary
            var mapArray,
                currentX = 0,
                currentY = 0,
                oldMapValue = "";

            function loadKeyHandler() {
                document.getElementById("mapOutput").addEventListener("keypress", keyHandler, false);
            }

            function keyHandler(e) {
                processCurrentKey(e.keyCode);
            }

            function processCurrentKey(key) {
                console.log(key);
                if (key == 38) { //Up
                    setSpotOnMap(currentX, currentY, oldMapValue);
                    currentY++;
                    oldMapValue = mapArray[currentY][currentX];
                    setSpotOnMap(currentX, currentY, "~");
                } else if (key == 40) { //Down
                    setSpotOnMap(currentX, currentY, oldMapValue);
                    currentY--;
                    oldMapValue = mapArray[currentY][currentX];
                    setSpotOnMap(currentX, currentY, "~");
                } else if (key == 37) { //Left
                    setSpotOnMap(currentX, currentY, oldMapValue);
                    currentX--;
                    oldMapValue = mapArray[currentY][currentX];
                    setSpotOnMap(currentX, currentY, "~");
                } else if (key == 39) { //Right
                    setSpotOnMap(currentX, currentY, oldMapValue);
                    currentX++;
                    oldMapValue = mapArray[currentY][currentX];
                    setSpotOnMap(currentX, currentY, "~");
                } else {
                    setSpotOnMap(currentX, currentY, String.fromCharCode(key));
                    currentX++;
                }
            }

            function setSpotOnMap(x, y, char) {
                mapArray[y][x] = char;
            }


            function drawMap() {
                var out = document.getElementById("mapOutput");
                var line;
                line = "map = ";
                for (let i = 0; i < mapArray.length; i++) {
                    for (let j = 0; j < mapArray[i].length; j++) {
                        line = line + mapArray[i][j];
                    }
                    line = line + "<br>" + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
                }
                out.innerHTML = line;
            }

            function defineMapSize() {
                var mapSizeX = parseInt(document.getElementById("mapSizeX").value),
                    mapSizeY = parseInt(document.getElementById("mapSizeY").value);
                    mapArray = [mapSizeY];
                for (let i = 0; i < mapSizeY; i++) {
                    mapArray[i] = new Array(mapSizeX);
                }

                for (let i = 0; i < mapArray.length; i++) {
                    for (let j = 0; j < mapArray[i].length; j++) {
                        mapArray[i][j] = ".";
                    }
                }
            }

        </script>

        <p id="mapOutput" tabindex="0"></p>
        <p id="output"></p>
        <p id="output2"></p>
        <p id="output3"></p>



        <p>X</p>
        <input type="number" id="mapSizeX">
        <p>Y</p>
        <input type="number" id="mapSizeY">

        <button onclick="defineMapSize();">Define Map mapSizeY</button>

        <button onclick="drawMap();">Draw Map</button>

    </body>
</html>
